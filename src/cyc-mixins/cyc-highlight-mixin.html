<link rel="import" href="../../bower_components/polymer/lib/utils/mixin.html">
<link rel="import" href="cyc-utils-mixin.html">

<script>
  // @namespace ColorYourCode
  window.ColorYourCode = window.ColorYourCode || {};

  /**
   * Mixin to highlight elements with the current `highlight` property as `data-prop` attribute value.
   * @polymer
   * @mixinFunction
   * @memberof ColorYourCode
   * @appliesMixin ColorYourCode.UtilsMixin
   */
  ColorYourCode.HighlightMixin = Polymer.dedupingMixin((superClass) => {
    return class extends ColorYourCode.UtilsMixin(superClass) {
      static get properties() {
        return {
          /**
           * Name of the UI item to highlight.
           */
          highlightSection: {
            type: String,
            observer: '_highlightSection',
          },
        };
      }

      _highlightSection(prop) {
        if (!this._uis) {
          this._uis = this.shadowRoot.querySelectorAll('[data-prop]');
        }
        for (const ui of this._uis) {
          ui.classList.toggle('highlight', ui.dataset.prop === prop);
        }
      }

      _onSectionMouseenter(event) {
        const dataset = event.currentTarget.dataset;
        const editorSection = dataset.prop || dataset.targetProp;
        this._emit('editor-section-hover', editorSection);
      }

      _onSectionMouseleave() {
        setTimeout(() => {
          this._emit('editor-section-hover');
        }, 100);
      }
    };
  });
</script>
